import { async } from '@angular/core/testing';
import { SelectItem } from 'ng2-select';
import { NotifyLoginService } from './../../../../../_services/manager/user/notify-login.service';
import { UserService } from './../../../../../_services/manager/user/user.service';
import { Component, OnInit, Input, Output, EventEmitter, OnDestroy } from '@angular/core';

@Component({
  selector: 'app-search-by-user',
  templateUrl: './search-by-user.component.html',
  styleUrls: ['./search-by-user.component.css']
})
export class SearchByUserComponent implements OnInit, OnDestroy {
  @Output() searchByUser: EventEmitter<SelectItem> = new EventEmitter<SelectItem>();
  public items  = [];
  private user: any ;
  active: any[] = []  ;
  isShow = false;
  constructor(private userService:  UserService, private notifyLoginService: NotifyLoginService) {
    this.isShow = false;
    this.items = [] ;
    this.items.push({ id: '*' , text: 'All user'});
    this.notifyLoginService.getInfo().subscribe((user: any ) => {
      if ( user ) {
        this.active.push( { id: user.id , text: '<< Me >>' });
        this.userService.getAllUser().subscribe( async (listUser: any[]) => {
          await listUser.forEach( item  => {
              this.items.push({ id: item.id  , text: (item.mail ===  user.email ) ? '<< Me >>' : item.mail });
          });
          this.isShow = true;
        });
      }
     }) ;
   }
  ngOnInit() {
  }
  refreshValue($event) {

  }
  selected($event) {
      console.log($event);
      this.searchByUser.emit($event);
  }
  removed($event) {
  }
  ngOnDestroy(): void {
    console.log('ngOnDestroy');
  }
}
